from BrandrdXMusic import app
import asyncio
import random

from pyrogram import filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant

# =================================
# ูุชุบูุฑุงุช ุนุงูุฉ
# =================================
spam_chats = []

# ุฅูููุฌู
MY_EMOJIS = ["๐", "๐", "๐ฅ", "๐", "๐ค", "โจ", "๐", "๐ง"]

# =================================
# ุฌููู ุงูุชุงู (ูุตุฑู ุฎููู + ูุฒุงุฑ + ูุดูุฏุฉ)
# =================================
TAGMES = [
    " **ุฃููููุงู ูุณููููุงู ููุง ููุฌูู ุงููุฌูุฑูุจ ูููุฑุช** ",
    " **ุฅููู ุงููุญููุงูุฉ ุฏู ุฏุฎููู ุชูููููู** ",
    " **ููููููู ููุง ุนูู ุฏู ุงููุฌูุฑูุจ ูุญูุด** ",
    " **ูููุฑุช ููุง ููุฒุงุฌ ุงููุฌูุฑูุจ ููููู** ",
    " **ุฅููู ุงูุฃุฎูุจูุงุฑ ููุง ุณูููุฏ ุงููููุฒุงุฑ** ",
    " **ุฏุฎููู ููุดูุฑู ูููุดูููู ุงููููู** ",
    " **ูุญูุดูููุง ูููุงููู ูุถูุญูููุชูู** ",
    " **ููุง ูููุง ุจูุงููููู ููููุง ููุฏุฎูู ูููููุฑ** ",
    " **ุฅููู ููุง ููุงุณ ุงูุฌูููุงู ุฏู** ",
    " **ููุฌูู ุฏุฎูู ุงููุดูุงุช ุฎูุฏูุง ุจูุงููููู** ",
    " **ูุญูุดูููุงู ููููู ุงููุบูููุงุจ ุฏู** ",
    " **ุฏุฎููู ุนูููู ุทููู ููุฒุงุฌ** ",
    " **ุฅููู ููุง ุนูู ุงูุณูููุฑ ุฏู** ",
    " **ุงููุฌูุฑูุจ ููููุฑ ูููุงุฑุฉ ุฌูุงููุฏุฉ** ",
    " **ุฅููู ุงููุถูุญูู ุฏู ุฌูู ููุนูุงู** ",
    " **ููุง ููุฑุญูุจ ููุง ููุฑุญูุจ** ",
    " **ููุงุณ ุชูุฏุฎูู ุชูููู ุงููุฒู** ",
    " **ุฅููู ููุง ุนูู ุฏู ููุญูู ููู ููุฑุญ** ",
    " **ุงููููุฒุงุฑ ูุตูู ููุนูุงู** ",
    " **ูุญูุดูุช ุงููููุนูุฏุฉ ููู ุบูููุฑูู** ",
    " **ุฅููู ููุง ููุฌูู ูููุฑุช ุงููููููุงู** ",
    " **ุฏุฎููู ููุนูููู ุญูุงููุฉ** ",
    " **ุฅููู ููุง ุนูู ุงููุดูููู ุฏู** ",
    " **ููุฒุงุฌูู ูุตูู ููุง ููุณูู** ",
    " **ูุญูุดูุช ุงููููููุฉ ุจูุฌููุฏู** ",
    " **ููุงุณ ุฏุฎููููููุง ููุชูุชูููู ููู ุงููููููุจ** ",
    " **ุฅููู ููุง ุฌูุฏุน ุงููููุฒุงุฑ ุฏู** ",
    " **ุงููุฌูุฑูุจ ููุงู ููุงุฏู ูุฌูู ุงููููุฑุญ** ",
    " **ูููุฑุช ููุง ููุจูููุฑ** ",
    " **ุฏุฎููู ููููู ุบูููุฑ ุณูููุงู** ",
    " **ุฅููู ุงููุญููุงูุฉ ุฏู ุฌูููููููุฉ** ",
    " **ููุงุณ ููุง ุชูุฏุฎูููุด ุณูููุช** ",
    " **ูุญูุดูููุง ุตููุชูู ููู ุงููููุฒุงุฑ** ",
    " **ุฅููู ููุง ุนูู ููุด ููุฏู** ",
    " **ุฏุฎููู ูููููู ุฃููู ุฌูู ุงููููุฒุงุฌ** ",
    " **ููุงุณ ุชูููุฑุญ ุงูููุนูุฏุฉ** ",
    " **ุฅููู ููุง ููุงุณ ุงููููู ุฏู** ",
    " **ูุญูุดูููุง ุงูููููุฉ ุจููุฌููุฏู** ",
    " **ููุง ููุฑุญูุจ ุจูุงููููุฑุญูุฉ** ",
    " **ุฏุฎููู ููุชูุญูุท ููู ุงููุจูุฑุงูููุฒ** ",
    " **ุฅููู ููุง ููุฌูู ุงููููุฒุงุฑ** ",
    " **ูููุฑุช ููุง ููุฒุงุฌ** ",
    " **ูุญูุดูููุง ุถูุญูููุชูู** ",
    " **ุฅููู ููุง ุฌูุฏุน ุงูููุนูุฏุฉ ููู** ",
    " **ุฏุฎููู ููุนูููู ุงูููููุฏ** ",
    " **ููุงุณ ุชูุฏุฎูู ุชูููุฑุญ** ",
    " **ููุง ูููุง ุจูุงููุฏุฎููู ุงููุญูููู** ",
    " **ุฅููู ููุง ููุงุณ ุงูุฌูููุงู ุฏู** ",
    " **ุงููุฌูุฑูุจ ุงุชููููุฑ ุฏูููููุชูู** ",
]

# =================================
# ุฃูุฑ ุงูุชุงู
# =================================
@app.on_message(
    filters.command(
        ["tagall", "all", "ุชุงู", "ููุดู", "ุงููู"],
        prefixes=["/", "@", ".", "#", ""]
    )
)
async def mentionall(client, message):
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("ุงูุฃูุฑ ุฏู ุดุบุงู ูู ุงูุฌุฑูุจุงุช ุจุณ.")

    try:
        member = await client.get_chat_member(message.chat.id, message.from_user.id)
        if member.status not in (ChatMemberStatus.ADMINISTRATOR, ChatMemberStatus.OWNER):
            return await message.reply("ุงูุฃูุฑ ุฏู ูููุดุฑููู ุจุณ.")
    except UserNotParticipant:
        return await message.reply("ุงูุฃูุฑ ุฏู ูููุดุฑููู ุจุณ.")

    if message.chat.id in spam_chats:
        return await message.reply("ูู ุชุงู ุดุบุงู ุฏูููุชูุ ุงุณุชูู ุดููุฉ.")

    spam_chats.append(message.chat.id)

    async for usr in client.get_chat_members(message.chat.id):
        if message.chat.id not in spam_chats:
            break
        if usr.user.is_bot:
            continue

        text = (
            f"<a href='tg://user?id={usr.user.id}'>{usr.user.first_name}</a> "
            f"{random.choice(TAGMES)} {random.choice(MY_EMOJIS)}"
        )

        await client.send_message(message.chat.id, text)
        await asyncio.sleep(4)

    if message.chat.id in spam_chats:
        spam_chats.remove(message.chat.id)

# =================================
# ุฅููุงู ุงูุชุงู
# =================================
@app.on_message(
    filters.command(
        ["tagoff", "tagstop", "ุจุณ ุชุงู", "ุงููุงู ุงูุชุงู", "ุจุณ ููุดู", "cancel"],
        prefixes=["/", "@", ".", "#", ""]
    )
)
async def cancel_tag(client, message):
    if message.chat.id not in spam_chats:
        return await message.reply("ูููุด ุชุงู ุดุบุงู ุฏูููุชู.")

    try:
        member = await client.get_chat_member(message.chat.id, message.from_user.id)
        if member.status not in (ChatMemberStatus.ADMINISTRATOR, ChatMemberStatus.OWNER):
            return await message.reply("ุงูุฃูุฑ ุฏู ูููุดุฑููู ุจุณ.")
    except UserNotParticipant:
        return await message.reply("ุงูุฃูุฑ ุฏู ูููุดุฑููู ุจุณ.")

    spam_chats.remove(message.chat.id)
    await message.reply("ุชูู ุฅููููุงู ุงููุชูุงู ูุงููููููุดูู ุจูููุฌูุงุญ ๐")
